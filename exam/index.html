<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rock Paper Scissors Cellular Automaton</title>
    <style>
      canvas {
        border: 1px solid #000;
        display: block;
        margin: 20px auto;
      }
    </style>
  </head>
  <body>
    <canvas id="canvas" width="400" height="400"></canvas>

    <script>
      const canvas = document.getElementById('canvas');
      const ctx = canvas.getContext('2d');
      const size = 10;
      const rows = canvas.width / size;
      const cols = canvas.height / size;
      const automaton = createAutomaton(rows, cols);

      function createAutomaton(rows, cols) {
        const automaton = new Array(rows)
          .fill(null)
          .map(() => new Array(cols).fill('R'));

        // Initialize with a Rock, Paper, Scissors pattern
        for (let i = 0; i < rows; i++) {
          for (let j = 0; j < cols; j++) {
            if ((i + j) % 3 === 0) {
              automaton[i][j] = 'R'; // Rock
            } else if ((i + j) % 3 === 1) {
              automaton[i][j] = 'P'; // Paper
            } else {
              automaton[i][j] = 'S'; // Scissors
            }
          }
        }

        return automaton;
      }

      function drawAutomaton() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        for (let i = 0; i < rows; i++) {
          for (let j = 0; j < cols; j++) {
            const state = automaton[i][j];
            const color =
              state === 'R' ? 'red' : state === 'P' ? 'blue' : 'green';
            ctx.fillStyle = color;
            ctx.fillRect(i * size, j * size, size, size);
          }
        }
      }

      function updateAutomaton() {
        const newAutomaton = new Array(rows)
          .fill(null)
          .map(() => new Array(cols).fill('R'));

        for (let i = 0; i < rows; i++) {
          for (let j = 0; j < cols; j++) {
            const state = automaton[i][j];
            const neighbors = getNeighbors(i, j);

            // Rule: Rock (R) beats Scissors (S), Scissors (S) beats Paper (P), Paper (P) beats Rock (R)
            if (state === 'R' && neighbors.includes('S')) {
              newAutomaton[i][j] = 'R';
            } else if (state === 'P' && neighbors.includes('R')) {
              newAutomaton[i][j] = 'P';
            } else if (state === 'S' && neighbors.includes('P')) {
              newAutomaton[i][j] = 'S';
            } else {
              newAutomaton[i][j] = state;
            }
          }
        }

        automaton = newAutomaton;
      }

      function getNeighbors(x, y) {
        const neighbors = [];

        for (let i = -1; i <= 1; i++) {
          for (let j = -1; j <= 1; j++) {
            const newX = x + i;
            const newY = y + j;

            if (
              newX >= 0 &&
              newX < rows &&
              newY >= 0 &&
              newY < cols &&
              !(i === 0 && j === 0)
            ) {
              neighbors.push(automaton[newX][newY]);
            }
          }
        }

        return neighbors;
      }

      function animate() {
        drawAutomaton();
        updateAutomaton();
        requestAnimationFrame(animate);
      }

      animate();
    </script>
  </body>
</html>
